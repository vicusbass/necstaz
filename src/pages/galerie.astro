---
import Layout from '../layouts/Layout.astro';
import { loadQuery } from '../utils/loadQuery';
import { galleryQuery } from '../queries/gallery';
import { categorizeGalleryImages, layoutGalleryImages } from '../utils/gallery';
import type { GalleryImage } from '../utils/gallery';
import heroDesktop from '../assets/gallery/hero.png';
import heroMobile from '../assets/gallery/hero-mobile.jpg';
import { Image } from 'astro:assets';

const { data } = await loadQuery<{ images: GalleryImage[] }>({
  query: galleryQuery,
});

const categorized = data?.images ? categorizeGalleryImages(data.images) : [];
const { desktop, mobile } = layoutGalleryImages(categorized);
---

<Layout title="Galerie | Nextaz">
  <!-- Hero Section - Desktop -->
  <section id="gallery-hero" class="relative hidden overflow-hidden lg:block">
    <Image
      src={heroDesktop}
      alt="Galerie Nextaz"
      class="w-full -translate-x-[5%] -translate-y-[15%] scale-130"
    />
    <!-- Text Overlay - Desktop -->
    <div class="absolute inset-0 flex flex-col items-start justify-center px-30 pt-[12%] text-left">
      <h1 class="mb-4 text-5xl leading-none font-bold lg:mb-12 lg:text-9xl">Galerie</h1>
      <h2 class="mb-6 text-2xl leading-none font-bold lg:text-5xl">Momentele tale cu Nextaz</h2>
      <p
        class="text-gray-dark mb-50 max-w-[600px] px-6 text-lg leading-relaxed lg:px-0 lg:text-xl lg:text-black"
      >
        Explorează universul Nextaz - de la fotografii de produs la momente surprinse în evenimente,
        seri tematice și petreceri.
      </p>
    </div>
  </section>

  <!-- Hero Section - Mobile -->
  <section class="lg:hidden">
    <Image src={heroMobile} alt="Galerie Nextaz" class="h-auto w-full object-cover" />
    <!-- Text Below Hero - Mobile -->
    <div class="flex flex-col items-center px-6 py-8 text-center">
      <h1 class="mb-4 text-5xl leading-none font-bold text-black">Galerie</h1>
      <h2 class="mb-4 text-xl leading-tight font-bold text-black">Momentele tale cu Nextaz</h2>
      <p class="text-gray-dark max-w-[350px] text-sm leading-relaxed">
        Explorează universul Nextaz – de la fotografii de produs la momente surprinse în evenimente,
        seri tematice și petreceri.
      </p>
    </div>
  </section>

  <!-- Gallery Grid -->
  <section class="container mx-auto px-4 py-8 lg:py-16">
    <!-- Desktop Layout -->
    <div class="hidden gap-4 lg:grid lg:grid-cols-2">
      {
        desktop.map((item) => (
          <div class={item.isRectangle ? 'col-span-2' : 'col-span-1'}>
            <img
              src={item.image.asset.url}
              alt={item.image.alt}
              class={
                item.isRectangle
                  ? 'h-auto w-full object-cover'
                  : 'aspect-square w-full object-cover'
              }
              loading="lazy"
              decoding="async"
            />
          </div>
        ))
      }
    </div>

    <!-- Mobile Layout -->
    <div class="grid grid-cols-1 gap-4 lg:hidden">
      {
        mobile.map((item) => (
          <img
            src={item.image.asset.url}
            alt={item.image.alt}
            class="aspect-square w-full object-cover"
            loading="lazy"
            decoding="async"
          />
        ))
      }
    </div>
  </section>
</Layout>
